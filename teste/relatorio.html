<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Respostas</title>
    <style>
        body {
            background-image: url('fundo.png');
            background-size: cover;
            background-position: center;
            color: #070606;
            font-family: 'Press Start 2P', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            width: 100%;
            margin: 50px auto;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-align: center;
            color: yellow;
        }

        h2 {
            font-size: 24px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #ff9900;
        }

        .questionario-item {
            margin-bottom: 20px;
            cursor: pointer;
        }

        .resumo {
            margin-top: 10px;
        }

        .resposta-correta {
            color: #2f8f2f;
            font-weight: bold;
        }

        .resposta-incorreta {
            color: #ff0000;
            font-weight: bold;
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: #c0392b;
            color: white;
            border: none;
            padding: 10px;
            text-transform: uppercase;
            border-radius: 20%;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-family: 'Press Start 2P', cursive;
            font-size: 16px;
            width: 80px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-button:hover {
            background-color: #a82f22;
        }

        .back-button::before {
            content: '←'; /* Unicode para seta esquerda */
            font-size: 20px;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 20px;
            }

            h2 {
                font-size: 18px;
            }

            .questionario-item {
                font-size: 16px;
            }

            .resumo {
                font-size: 14px;
            }

            .back-button {
                font-size: 12px;
                width: 30px;
                height: 30px;
            }

            .back-button::before {
                font-size: 16px;
            }
        }
    </style>
    <!-- Incluir o link da fonte Press Start 2P -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <button class="back-button" onclick="window.location.href='menu_professor.html'"></button>
    <h1>Relatório de Respostas</h1>
    <div class="container" id="relatorio">
        <!-- Lista de questionários será inserida aqui via JavaScript -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/parse/2.18.0/parse.min.js"></script>
    <script>
        Parse.initialize("uICi8xqYEQ7dpHbf2rGjuKjMnyYnFLTJBCHg056J", "jqu44b1D0lMX47pRUz72PC3HL8CovkAja8kW2QxP");
        Parse.serverURL = 'https://parseapi.back4app.com/';

        document.addEventListener('DOMContentLoaded', function() {
            const relatorioDiv = document.getElementById('relatorio');

            // 1. Recuperar todos os questionários
            fetchQuestionarios().then(questionarios => {
                // 2. Exibir a lista de questionários
                exibirQuestionarios(questionarios, relatorioDiv);
            });
        });

        function fetchQuestionarios() {
            const Questionario = Parse.Object.extend('Questionario');
            const query = new Parse.Query(Questionario);
            return query.find();
        }

        function exibirQuestionarios(questionarios, container) {
            questionarios.forEach(questionario => {
                const questionarioItem = document.createElement('div');
                questionarioItem.classList.add('questionario-item');
                questionarioItem.innerHTML = `<h2>${questionario.get('titulo')}</h2>`;
                questionarioItem.addEventListener('click', () => {
                    mostrarRespostas(questionario, container); // Passando container como parâmetro
                });
                container.appendChild(questionarioItem);
            });
        }

        function mostrarRespostas(questionario, container) { // Adicionando container como parâmetro
            const Pergunta = Parse.Object.extend('Pergunta');
            const query = new Parse.Query(Pergunta);
            query.equalTo('questionario', questionario);
            query.find().then(perguntas => {
                let acertos = 0;
                let erros = 0;

                let resumoHTML = '';

                perguntas.forEach(pergunta => {
                    const respostaCorreta = pergunta.get('respostaCorreta');
                    const respostaUsuario = pergunta.get('respostaUsuario');

                    if (respostaUsuario === respostaCorreta) {
                        acertos++;
                        resumoHTML += `<p class="resposta-correta">Pergunta: ${pergunta.get('texto')} - Resposta: ${respostaUsuario}</p>`;
                    } else {
                        erros++;
                        resumoHTML += `<p class="resposta-incorreta">Pergunta: ${pergunta.get('texto')} - Resposta: ${respostaUsuario}</p>`;
                    }
                });

                const resumo = document.createElement('div');
                resumo.classList.add('resumo');
                resumo.innerHTML = `
                    <h2>Resumo do Questionário "${questionario.get('titulo')}"</h2>
                    <p>Quantidade de Acertos: ${acertos}</p>
                    <p>Quantidade de Erros: ${erros}</p>
                    ${resumoHTML}
                `;

                container.innerHTML = '';
                container.appendChild(resumo);
            });
        }
    </script>
</body>
</html>
